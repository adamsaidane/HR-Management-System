@model HRMS.ViewModels.PaginatedList<HRMS.Models.JobOffer>
@{
    ViewData["Title"] = "Offres d'Emploi";
}

<div class="page-header d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-briefcase me-2"></i>Offres d'Emploi</h1>
    <a asp-action="CreateJobOffer" class="btn btn-primary btn-lg">
        <i class="fas fa-plus me-2"></i>Nouvelle Offre
    </a>
</div>

<div class="row">
    @foreach (var offer in Model)
    {
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">@offer.Title</h5>
                </div>
                <div class="card-body">
                    <p class="mb-2"><i class="fas fa-building me-2"></i>@offer.Department.Name</p>
                    <p class="mb-2"><i class="fas fa-user-tie me-2"></i>@offer.Position.Title</p>
                    <p class="mb-2"><i class="fas fa-calendar me-2"></i>@offer.PostDate.ToString("dd/MM/yyyy")</p>
                    <p class="mb-2">
                        <span class="badge bg-@(offer.Status == HRMS.Enums.JobOfferStatus.Ouverte ? "success" : "secondary")">
                            @offer.Status
                        </span>
                    </p>
                    <p class="text-muted small">@offer.Candidates.Count candidat(s)</p>
                </div>
                <div class="card-footer bg-white">
                    <a asp-action="Candidates" asp-route-jobOfferId="@offer.JobOfferId" class="btn btn-sm btn-info">
                        <i class="fas fa-users me-1"></i>Candidats
                    </a>
                    @if (offer.Status == HRMS.Enums.JobOfferStatus.Ouverte)
                    {
                        <form method="post" asp-action="CloseJobOffer" asp-route-id="@offer.JobOfferId" class="d-inline">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-sm btn-warning" onclick="return confirm('Fermer cette offre?')">
                                <i class="fas fa-lock"></i> Fermer
                            </button>
                        </form>
                    }
                </div>
            </div>
        </div>
    }
    <partial name="_Pagination" model="Model" />
</div>